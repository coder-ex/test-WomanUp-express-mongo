### ТЗ откомпании [WomanUp](https://womanup.online/)

*установленные пакеты:*
>
    express dotenv mongoose db-migrate bcrypt express-validator --save
    nodemon --save-dev

*тестовая DB - [MongoDB](https://cloud.mongodb.com):*
>
    DB: todo_lists
    user: barbarian
    password: u8VOnzbfV51DVraW

*настройка [migrate-mongo](https://github.com/seppevs/migrate-mongo)*
* предварительно создать конфигурационный файл (для ES6 + ... -m esm)
    ./node_modules/.bin/migrate-mongo init -m esm

*IP & ADDR*
>
    localhost:8000
    192.168.222.1:8000
    school.loc

---
>
    ОПИСАНИЕ ТЗ

    Что нужно сделать:
    — написать API для todo-лист

    Функционал:
    * Регистрация/авторизация пользователя. При авторизации пользователь на клиент получает JWT из которого можно получить id пользователя.
    * Авторизованному пользователю доступны CRUD endpoints для сущности todo (должен быть middleware в котором будет проверка валидного токена)
    * Доступно получение todo как все разом, так и постранично. Возможны фильтры

    - Стек технологий:
    * NodeJS
    * Express
    * MongoDB/Mongoose (mongoDb Atlas)
    * JWT
    * bcrypt (для хеширования пароля)


    Нужно обязательно:
    — откомментировать код в JSDoc и выложить на github.
    — написать код самому,  а не скопировать с stackoverflow;

    Желательно:
    — Настроить Cors;
    — будет плюсом если API будет опубликовано на бесплатном сервисе (например Vercel)
    — Будет возможность загружать файлы с клиента и затем раздавать статику;

> *прим: Для дальнейшей обратной связи и назначения собеседования по итогу готовности тестового задания необходимо связаться через Telegram @natali_ababij. В начале сообщения поставить #вакансия*

---

*реализовано REST API*

* GET:    /api/seed/roles - создание ролей [ USER, ADMIN ] - переписать под Node.js CLI command
* GET:    /api/seed/todos - загрузка тестовых TODO`s - переписать под Node.js CLI command

* POST:   /api/auth/registration - регистрация пользователя
* GET:    /api/auth/activate/:link - активация по ссылке
* POST:   /api/auth/login - авторизация пользователя
* POST:   /api/auth/logout - разлогирование пользователя (только авторизованный USER)
* GET:    /api/auth/refresh (token) - обновление refresh токена (только авторизованный ADMIN | USER)

* GET:    /api/users/all - вывод всех пользователей (только авторизованный ADMIN)
* GET:    /api/users/:id - вывод данных пользователя по id пользователя (только авторизованный ADMIN | USER)
* PATCH:  /api/users/:id - изменение данных пользователя по id пользователя (только авторизованный ADMIN | USER)
* DELETE: /api/users/:id - удаление пользователя по id пользователя (только авторизованный ADMIN | USER)

* PUT:    /api/upload/:id - загрузка аватарок, привязка к профилю пользователя по id пользователя (только авторизованный USER)
* GET:    /api/upload - получение всех аваторок (только авторизованный ADMIN | USER)

* POST:   /api/todo - создание заметки (только авторизованный ADMIN | USER)
* GET:    /api/todo/:userId/:todoId - посмотреть заметку по id (только авторизованный ADMIN | USER)
* PUT:    /api/todo/:userId/:todoId - редактирование заметки по id (только авторизованный ADMIN | USER)
* GET:    /api/todo/:userId - вывод всех заметок по id пользователя (только авторизованный ADMIN | USER)
* GET:    /api/todo - вывод всех заметок в системе (только авторизованный ADMIN)

---

*дополительные данные*
1. использование миграций
2. использование транзакций [ особенность MongoDB обязательная репликация БД для транзакций ]:
3. тестировалось на облачной БД где репликация встроена в облако

        > в каталоге docker есть конфиги для docker-compose + dockerfile под шардирование MongoDB контейнерах docker
        > требуется донастройка под проект в части создания пользователя admin + пользователя БД + пароли + права доступа

4. аватарки грузятся на сервер проекта, желательно реализовать загрузку на AWS S3
5. дополнительные файлы в каталоге проекта ./doc:
        
        > diagram-table-export.dia - схема связей таблиц проекта
        > docs/ - описание API в JSDoc формате
        > WomanUp-API.postman_collection.json - коллекция Postman [ адрес в коллекции http://school.loc заменить на реальный ]

6. реализована пагинация заметок (TODO) со смещением
[пример по пагинации взят тут](https://cloudnweb.dev/2021/04/pagination-nodejs-mongoose/)

*!! перед стартом выполнить создание ролей и подгрузку тестовых todo !!*

---